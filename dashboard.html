<script>
	$(document).ready(function(){
		var projects = [];		
		
		$("#calendar").fullCalendar({
			header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month,agendaWeek,agendaDay,listWeek'
			},
			weekends: false,
			nowIndicator: true,
			events: function(start, end, callback){
				$.ajax({
					url: 'http://localhost:8080/projects'
				}).then(function(projects){
					//console.log("AJAX CALL PERFORMED");
					for(var count = 0; count < projects.length; count++){
						var event = {
							title: projects[count].description,
							start: projects[count].start_date,
							end: projects[count].deadline,
							textColor: 'black'
						};
						$("#calendar").fullCalendar('renderEvent', event);
					}
				});		
			}
		});
	});
</script>
<div id="bodyDiv">
	<div id="tabDiv">
		<ul class="nav nav-tabs">
			<li role="presentation" class="active"><a href="#/"><span class="glyphicon glyphicon-globe"></span> Dashboard</a></li>
			<li role="presentation"><a href="#/viewAllTeams"><span class="glyphicon glyphicon-list-alt"></span> View All Teams</a></li>
			<li role="presentation"><a href="#/viewAllProjects"><span class="glyphicon glyphicon-list"></span> View All Projects</a></li>
			<li role="presentation"><a href="#/viewAllMembers"><span class="glyphicon glyphicon-user"></span> View All Team Members</a></li>
		</ul>		
	</div>
	<div id="listContainer">
		<div class="table-responsive" id ="projectListDiv">
			<div class="mainDivsHeader">
				<h3>Projects That Need Attention</h3>				
			</div>
			<div class="tableDiv">
				<table class="table">
					<tr><th>Name</th><th>Deadline</th><th>Progress</th><th>Actions</th></tr>
					<tr ng-repeat="project in ctrl.projects | orderBy:project.project_health:true" ng-if="project.project_health < 100 && ctrl.today < project.deadline">
						<td>{{project.name}}</td>
						<td>{{project.deadline | date:'MMM dd, yyyy'}}</td>
						<td>
							<progress max="100" value="{{project.project_health}}"></progress>
							<label>{{project.project_health}}% Health</label>
						</td>
						<td>
							<div class="btn-group">
								<button class="btn btn-default" title="Update Project" ng-click="ctrl.toUpdProj(project.id)"><span class="glyphicon glyphicon-pencil"></span></button>
								<button class="btn btn-info" title="Add a Comment"><span class="glyphicon glyphicon-comment"></span></button>
							</div>
						</td>
					</tr>
				</table>
			</div>
		</div>
		<div id="calendarDiv">
			<div id="calendar"></div>
		</div>
	</div>
</div>